<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Autonomous Navigation in Dark Unknown Environments using Vision</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body {
      background: linear-gradient(135deg, #0b0f17, #1c2230);
      color: #f5f5f5;
      display: flex; flex-direction: column; align-items: center;
      min-height: 100vh; overflow-x: hidden;
    }

    /* HEADER */
    header { margin-top: 60px; max-width: 1000px; width: 90%; text-align: center; }
    .header-top { display: flex; align-items: center; justify-content: space-between; gap: 20px; flex-wrap: wrap; }
    .corner-logo { height: 70px; object-fit: contain; }
    header h1 {
      flex: 1; font-size: 2.2rem; font-weight: 600;
      background: linear-gradient(to right, #56ccf2, #2f80ed);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      text-align: center; margin: 0 10px;
    }
    header p { font-size: 1rem; color: #c5c5c5; margin-top: 8px; }
    .supervisors { margin-top: 6px; font-size: 0.95rem; color: #a5a5a5; }
    a.email-link { color: #56ccf2; text-decoration: none; transition: color 0.3s ease; }
    a.email-link:hover { color: #2f80ed; text-decoration: underline; }

    /* STICKY BAR */
    .sticky-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      min-height: 65px; /* allow flexible height for wrapped titles */
      background: rgba(15, 20, 30, 0.9);
      backdrop-filter: blur(8px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 20px;
      opacity: 0;
      pointer-events: none;
      transform: translateY(-100%);
      transition: opacity 0.4s ease, transform 0.4s ease;
      z-index: 100;
      flex-wrap: wrap; /* ✅ allow content wrapping */
    }
    
    .sticky-bar.visible {
      opacity: 1;
      pointer-events: all;
      transform: translateY(0);
    }
    
    .sticky-logo {
      height: 40px; /* ✅ slightly smaller for mobile */
      object-fit: contain;
    }
    
    .sticky-title {
      flex: 1;
      text-align: center;
      font-size: 1rem;
      font-weight: 500;
      background: linear-gradient(to right, #56ccf2, #2f80ed);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 5px 10px; /* ✅ give breathing space */
      line-height: 1.3;
      word-wrap: break-word; /* ✅ prevent overflow */
      overflow-wrap: break-word;
    }

    /* TABS */
    .tabs { display: flex; justify-content: center; align-items: center; gap: 40px; flex-wrap: wrap; margin: 70px 20px; }
    .tab {
      background: #1e2738; border-radius: 15px; width: 260px; height: 160px; text-align: center;
      display: flex; justify-content: center; align-items: center; color: #fff; text-decoration: none;
      font-size: 1.1rem; font-weight: 500; box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      transition: all 0.3s ease; position: relative; cursor: pointer;
    }
    .tab::before {
      content: ''; position: absolute; inset: 0; border-radius: 15px;
      background: linear-gradient(135deg, #2f80ed, #56ccf2); opacity: 0; transition: opacity 0.3s ease; z-index: -1;
    }
    .tab:hover { transform: translateY(-6px) scale(1.05); color: #fff; }
    .tab:hover::before { opacity: 1; }

    /* SUMMARY */
    .summary {
      max-width: 850px; text-align: justify; line-height: 1.6; color: #d6d6d6;
      margin: 40px 20px 40px 20px; background: rgba(255,255,255,0.05);
      padding: 25px 30px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.3);
    }
    .summary h2 { text-align: center; font-size: 1.5rem; color: #56ccf2; margin-bottom: 15px; }

    /* GALLERY */
    .gallery-section { max-width: 950px; margin: 40px auto; text-align: center; }
    .gallery-section h2 { font-size: 1.5rem; color: #56ccf2; margin-bottom: 25px; }
    .gallery-grid {
      display: grid; grid-template-columns: repeat(3, 1fr);
      gap: 15px; padding: 0 20px;
    }
    .gallery-item {
      position: relative; cursor: pointer; border-radius: 12px; overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3); transition: transform 0.3s ease;
    }
    .gallery-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
    .gallery-item:hover img { transform: scale(1.05); }

    /* IMAGE MODAL */
    .image-modal {
      display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
      justify-content: center; align-items: center; z-index: 2000;
    }
    .image-modal img {
      max-width: 90%; max-height: 90vh; border-radius: 10px;
      box-shadow: 0 0 25px rgba(86, 204, 242, 0.4);
    }
    .close-modal {
      position: absolute; top: 15px; right: 25px; font-size: 30px; color: #fff;
      cursor: pointer; font-weight: bold; transition: color 0.3s ease;
    }
    .close-modal:hover { color: #56ccf2; }

    footer { text-align: center; font-size: 0.85rem; color: #808080; margin: 40px 0; }

    /* VIDEO MODALS */
    .video-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); justify-content: center; align-items: center; z-index: 1001; }
    .video-container { position: relative; width: 80%; max-width: 800px; background: #000; border-radius: 10px; overflow: hidden; box-shadow: 0 0 25px rgba(86,204,242,0.4); }
    iframe, video { width: 100%; height: 450px; border: none; outline: none; }
    .close-btn { position: absolute; top: 10px; right: 15px; color: #fff; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.3s ease; }
    .close-btn:hover { color: #56ccf2; }

    /* --- MOBILE OPTIMIZATION --- */
    @media (max-width: 768px) {
      .pipeline-wrapper {
        /* 1. Define a safe height for the animation area */
        height: 160px; 
        overflow: hidden; 
        
        /* 2. Use Flexbox to force the grid to the center of the screen */
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .pipeline-grid {
        /* 3. Force Desktop Width: Keep internal math (1000px) intact */
        width: 1000px;
        max-width: none;
        
        /* 4. SHRINK IT: Scale down to ~35% so 1000px fits into ~350px screens */
        transform: scale(0.35);
        
        /* 5. Anchor the shrink to the center */
        transform-origin: center center;
        
        /* 6. Ensure no offsets or positioning interfere */
        margin: 0;
        position: relative; /* Keep it in flow, not absolute */
        left: auto;
        top: auto;
      }
    }
    
    @media (max-width: 480px) {
      .gallery-grid { grid-template-columns: 1fr; }
    }

    /* ================= SYNCED PIPELINE ANIMATION ================= */
    .pipeline-section {
      width: 100%;
      max-width: 1200px;
      margin: 50px auto;
      text-align: center;
      overflow: hidden;
      padding: 40px 0;
    }
    .pipeline-section h2 {
      font-size: 1.8rem;
      color: #56ccf2;
      margin-bottom: 40px;
    }

    /* THE WRAPPER: Now acts as a Flex container to center content perfectly */
    .pipeline-wrapper {
      position: relative;
      width: 100%;
      height: 240px;
      background: rgba(255, 255, 255, 0.02);
      border-y: 1px solid rgba(86, 204, 242, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden; /* Ensures the scaled content never spills out */
    }

    /* --- THE GRID SYSTEM --- */
    .pipeline-grid {
      display: grid;
      grid-template-columns: repeat(9, 1fr); 
      align-items: center;
      justify-items: center;
      width: 1000px; /* Fixed width helps maintain animation consistency */
      max-width: 95%; /* Responsive on Desktop */
      position: relative;
    }

    /* --- 1. INPUT / OUTPUT --- */
    .io-stage {
      position: relative;
      width: 60px; height: 60px;
      display: flex; justify-content: center; align-items: center;
    }
    .io-img {
      width: 100%; height: 100%;
      border-radius: 6px;
      border: 2px solid #56ccf2;
      object-fit: cover;
      background: #000;
      box-shadow: 0 0 10px rgba(86, 204, 242, 0.3);
    }

    /* Input shrinks at start (0-5%) */
    .input-anim { animation: shrinkInput 20s linear infinite; }
    @keyframes shrinkInput {
      0% { transform: scale(1); opacity: 1; }
      5% { transform: scale(0); opacity: 0; }
      95% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Output expands at end (85-90%) */
    .output-anim { animation: expandOutput 20s linear infinite; transform: scale(0); }
    @keyframes expandOutput {
      0%, 85% { transform: scale(0); opacity: 0; }
      90% { transform: scale(1.5); opacity: 1; }
      95%, 100% { transform: scale(1); opacity: 1; }
    }

    /* --- 2. THE DOT --- */
    .traveling-dot {
      position: absolute;
      top: 50%;
      left: 0; 
      width: 14px; height: 14px;
      background: #56ccf2;
      border-radius: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 15px #56ccf2;
      z-index: 50;
      pointer-events: none;
      animation: dotMove 20s linear infinite;
    }

    @keyframes dotMove {
      /* Step 0: At Input */
      0%   { left: 0%; opacity: 0; }
      2%   { opacity: 1; } 
      5%   { left: 0%; opacity: 1; } 
      
      /* Move to Enc1 (12.5%) */
      9%   { left: 12.5%; opacity: 1; }
      10%  { opacity: 0; } 
      15%  { opacity: 0; } 
      16%  { opacity: 1; } 

      /* Move to Enc2 (25%) */
      19%  { left: 25%; opacity: 1; }
      20%  { opacity: 0; }
      25%  { opacity: 0; }
      26%  { opacity: 1; }

      /* Move to Enc3 (37.5%) */
      29%  { left: 37.5%; opacity: 1; }
      30%  { opacity: 0; }
      35%  { opacity: 0; }
      36%  { opacity: 1; }

      /* Move to Bottleneck (50%) */
      39%  { left: 50%; opacity: 1; }
      40%  { opacity: 0; }
      45%  { opacity: 0; }
      46%  { opacity: 1; }

      /* Move to Dec3 (62.5%) */
      49%  { left: 62.5%; opacity: 1; }
      50%  { opacity: 0; }
      55%  { opacity: 0; }
      56%  { opacity: 1; }

      /* Move to Dec2 (75%) */
      59%  { left: 75%; opacity: 1; }
      60%  { opacity: 0; }
      65%  { opacity: 0; }
      66%  { opacity: 1; }

      /* Move to Dec1 (87.5%) */
      69%  { left: 87.5%; opacity: 1; }
      70%  { opacity: 0; }
      75%  { opacity: 0; }
      76%  { opacity: 1; }

      /* Move to Output (100%) */
      84%  { left: 100%; opacity: 1; }
      85%  { opacity: 0; } 
      100% { left: 100%; opacity: 0; }
    }

    /* --- 3. LAYERS --- */
    .layer-box {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      overflow: visible; 
    }

    .layer-shape {
      background: #1e2738;
      border: 1px solid #2f80ed;
      border-radius: 4px;
      position: relative;
      z-index: 10;
      transition: border-color 0.2s;
      animation: zIndexBump 20s linear infinite;
      animation-delay: var(--delay);
    }

    .layer-shape::after {
      content: "";
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 100%; height: 100%;
      
      background-image: var(--img);
      background-size: cover;
      background-position: center;
      border: 2px solid #56ccf2;
      box-shadow: 0 0 25px rgba(0,0,0,0.9);
      
      opacity: 0;
      pointer-events: none;
      animation: popImage 20s linear infinite;
      animation-delay: var(--delay);
    }

    @keyframes zIndexBump {
      0% { z-index: 10; border-color: #2f80ed; }
      0.1% { z-index: 500; border-color: #fff; } 
      5% { z-index: 10; border-color: #2f80ed; } 
      100% { z-index: 10; }
    }

    @keyframes popImage {
      0% { opacity: 0; width: 100%; height: 100%; }
      0.1% { opacity: 1; background-color: #000; }
      1%, 4% { opacity: 1; width: 150px; height: 150px; } 
      5% { opacity: 0; width: 100%; height: 100%; }
      100% { opacity: 0; }
    }

    .s-32  { width: 20px; height: 90px; }
    .s-64  { width: 25px; height: 70px; }
    .s-128 { width: 30px; height: 50px; }
    .s-256 { width: 40px; height: 40px; border-color: #fff; }

    .d-1 { --delay: 2s; }
    .d-2 { --delay: 4s; }
    .d-3 { --delay: 6s; }
    .d-4 { --delay: 8s; }
    .d-5 { --delay: 10s; }
    .d-6 { --delay: 12s; }
    .d-7 { --delay: 14s; }

    .connector-line {
      position: absolute;
      top: 50%; left: 0;
      width: 100%; height: 2px;
      background: rgba(255, 255, 255, 0.1);
      z-index: 0;
    }

    /* --- MOBILE OPTIMIZATION (THE FIX) --- */
    @media (max-width: 768px) {
      .pipeline-wrapper {
        /* 1. Reduce height to save screen space */
        height: 160px;
        
        /* 2. Use Flexbox to PERFECTLY center whatever is inside */
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .pipeline-grid {
        /* 3. Force the grid to think it is Desktop size (1000px) 
              so that the animation math/distances remain correct. */
        width: 1000px;
        max-width: none; 

        /* 4. Shrink the whole 1000px block down to 35% size (approx 350px)
              This fits perfectly on mobile screens. */
        transform: scale(0.35);
        transform-origin: center center;

        /* 5. No margins, no left/right positioning. Just pure scale in the center. */
        margin: 0;
      }
    }
  </style>
</head>
<body>

<header id="header">
  <div class="header-top">
    <img src="images/uom.png" alt="Left Logo" class="corner-logo">
    <h1>Autonomous Navigation in Dark Unknown Environments using Vision</h1>
    <img src="images/raico.png" alt="Right Logo" class="corner-logo">
  </div>
  <p><strong>PhD Student:</strong> <a href="mailto:nathan.shankar@postgrad.manchester.ac.uk" class="email-link">Nathan Shankar</a></p>
  <p class="supervisors">
    Supervisors:
    <a href="mailto:pawel.ladosz@manchester.ac.uk" class="email-link">Pawel Ladosz</a> &nbsp; | &nbsp;
    <a href="mailto:hujun.yin@manchester.ac.uk" class="email-link">Hujun Yin</a>
  </p>
</header>

<div class="sticky-bar" id="stickyBar">
  <img src="images/uom.png" alt="Left Logo" class="sticky-logo">
  <div class="sticky-title">Autonomous Navigation in Dark Unknown Environments using Vision</div>
  <img src="images/raico.png" alt="Right Logo" class="sticky-logo">
</div>

<!-- Tabs -->
<div class="tabs">
  <div class="tab" id="goals-tab">Research Goals</div>
  <div class="tab" id="demo-tab">Autonomous Exploration in the Dark Demo</div>
  <div class="tab" id="ir-tab">Object Detection using Infrared Camera Demo</div>
  <a href="https://arxiv.org/pdf/2510.04883" target="_blank" class="tab">Research Paper</a>
</div>

<!-- Summary -->
<section class="summary">
  <h2>About the Research</h2>
  <p>Robots struggle when the lights go out, resulting in camera failure, loss of localization, and breakdown of navigation systems.
     This research aims to give robots the ability to perceive and navigate reliably in complete darkness by combining infrared sensing,
     intelligent image enhancement, and spatial awareness.
  </p><br>
  <p>The goal is to make vision reliable anywhere without relying on a multitude of sensors.
     By leveraging infrared perception and learning-based enhancement, robots can reconstruct their surroundings,
     recognize objects, and navigate safely in environments where conventional vision fails.
     This research has significant implications for autonomous exploration, search and rescue, warehouse fleets,
     nuclear inspection, and planetary robotics.
  </p>
</section>

<section class="pipeline-section">
  <h2>Processing Pipeline</h2>
  
  <div class="pipeline-wrapper">
    
    <div class="pipeline-grid">
      <div class="connector-line"></div>

      <div class="traveling-dot"></div>

      <div class="io-stage">
        <img src="layer/input_image.png" class="io-img input-anim" alt="Input">
        <span style="position: absolute; bottom: -30px; font-size: 0.7rem; color: #888; width: 100px;">Noisy Input</span>
      </div>

      <div class="layer-box">
        <div class="layer-shape s-32 d-1" style="--img: url('layer/00_conv2d.png')"></div>
      </div>

      <div class="layer-box">
        <div class="layer-shape s-64 d-2" style="--img: url('layer/02_conv2d_1.png')"></div>
      </div>

      <div class="layer-box">
        <div class="layer-shape s-128 d-3" style="--img: url('layer/04_conv2d_2.png')"></div>
      </div>

      <div class="layer-box">
        <div class="layer-shape s-256 d-4" style="--img: url('layer/06_conv2d_3.png')"></div>
      </div>

      <div class="layer-box">
        <div class="layer-shape s-128 d-5" style="--img: url('layer/08_conv2d_4.png')"></div>
      </div>

      <div class="layer-box">
        <div class="layer-shape s-64 d-6" style="--img: url('layer/10_conv2d_5.png')"></div>
      </div>

      <div class="layer-box">
        <div class="layer-shape s-32 d-7" style="--img: url('layer/12_conv2d_6.png')"></div>
      </div>

      <div class="io-stage">
        <img src="layer/13_conv2d_7.png" class="io-img output-anim" alt="Output">
        <span style="position: absolute; bottom: -30px; font-size: 0.7rem; color: #888; width: 100px;">Clean Output</span>
      </div>

    </div>

  </div>

  <p style="margin-top: 15px; color: #aaa; font-size: 0.9rem;">
    <strong>Under the hood:</strong> The noisy input is compressed into latent features (bottleneck) 
    and reconstructed. Different layers reveal their internal feature maps during processing.
  </p>
</section>

<!-- Gallery -->
<section class="gallery-section">
  <h2>Research Gallery</h2>
  <div class="gallery-grid" id="gallery"></div>
</section>

<footer>© 2025 Nathan Shankar — University of Manchester</footer>

<!-- IMAGE MODAL -->
<div class="image-modal" id="imageModal">
  <span class="close-modal" id="closeImageModal">&times;</span>
  <img id="modalImg" src="" alt="">
</div>

<!-- VIDEO MODALS -->
<div class="video-modal" id="goals-modal">
  <div class="video-container">
    <span class="close-btn" data-close="goals-modal">&times;</span>
    <iframe id="goals-iframe" data-src="https://www.youtube.com/embed/RJ8qQAx-SoI?autoplay=1"></iframe>
  </div>
</div>
<div class="video-modal" id="demo-modal">
  <div class="video-container">
    <span class="close-btn" data-close="demo-modal">&times;</span>
    <video id="nav-video" controls><source src="nav_in_dark.mp4" type="video/mp4"></video>
  </div>
</div>
<div class="video-modal" id="ir-modal">
  <div class="video-container">
    <span class="close-btn" data-close="ir-modal">&times;</span>
    <video id="ir-video" controls><source src="ir_object_detect_1.mp4" type="video/mp4"></video>
  </div>
</div>

<script>
  // Sticky header
  const header = document.getElementById('header');
  const stickyBar = document.getElementById('stickyBar');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (!entry.isIntersecting || entry.intersectionRatio < 1) stickyBar.classList.add('visible');
      else stickyBar.classList.remove('visible');
    });
  }, { threshold: Array.from({ length: 100 }, (_, i) => i / 100) });
  observer.observe(header);

  // Video modal logic
  const openModal = id => {
    closeAllVideos();
    const modal = document.getElementById(id);
    modal.style.display = 'flex';
    const iframe = modal.querySelector('iframe');
    if (iframe) iframe.src = iframe.dataset.src;
    const video = modal.querySelector('video');
    if (video) video.play();
  };
  const closeModal = id => {
    const modal = document.getElementById(id);
    modal.style.display = 'none';
    const iframe = modal.querySelector('iframe');
    const video = modal.querySelector('video');
    if (iframe) iframe.src = '';
    if (video) { video.pause(); video.currentTime = 0; }
  };
  const closeAllVideos = () => document.querySelectorAll('.video-modal').forEach(m => closeModal(m.id));
  document.getElementById('goals-tab').onclick = () => openModal('goals-modal');
  document.getElementById('demo-tab').onclick = () => openModal('demo-modal');
  document.getElementById('ir-tab').onclick = () => openModal('ir-modal');
  document.querySelectorAll('.close-btn').forEach(btn => btn.addEventListener('click', e => closeModal(e.target.dataset.close)));
  window.onclick = e => { if (e.target.classList.contains('video-modal')) closeModal(e.target.id); };

  // ======== GALLERY LOGIC ========
  const gallery = document.getElementById('gallery');
  const imageModal = document.getElementById('imageModal');
  const modalImg = document.getElementById('modalImg');
  const closeImageModal = document.getElementById('closeImageModal');

  // Fisher-Yates Shuffle
  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  fetch('uploads/index.json')
    .then(res => res.json())
    .then(photos => {
      photos = shuffleArray(photos); // Shuffle before displaying
      photos.forEach(src => {
        const div = document.createElement('div');
        div.className = 'gallery-item';
        const img = document.createElement('img');
        img.src = src;
        div.appendChild(img);
        div.onclick = () => {
          modalImg.src = src;
          imageModal.style.display = 'flex';
        };
        gallery.appendChild(div);
      });
    })
    .catch(err => {
      console.error("Could not load image list:", err);
      gallery.innerHTML = "<p style='color:#999;'>No images found in uploads folder.</p>";
    });

  closeImageModal.onclick = () => imageModal.style.display = 'none';
  window.addEventListener('click', e => { if (e.target === imageModal) imageModal.style.display = 'none'; });
</script>
</body>
</html>
