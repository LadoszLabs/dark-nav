<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Autonomous Navigation in Dark Unknown Environments using Vision</title>
  <style>
    /* --- GLOBAL STYLES --- */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body {
      background: linear-gradient(135deg, #0b0f17, #1c2230);
      color: #f5f5f5;
      display: flex; flex-direction: column; align-items: center;
      min-height: 100vh; overflow-x: hidden;
    }

    /* --- HEADER --- */
    header { margin-top: 60px; max-width: 1000px; width: 90%; text-align: center; }
    
    .header-top { 
      display: flex; 
      align-items: center; 
      justify-content: space-between; 
      gap: 20px; 
      flex-wrap: wrap; 
    }
    
    .corner-logo { height: 70px; object-fit: contain; }
    
    header h1 {
      flex: 1; font-size: 2.2rem; font-weight: 600;
      background: linear-gradient(to right, #56ccf2, #2f80ed);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      text-align: center; margin: 0 10px;
    }
    
    header p { font-size: 1rem; color: #c5c5c5; margin-top: 8px; }
    .supervisors { margin-top: 6px; font-size: 0.95rem; color: #a5a5a5; }
    a.email-link { color: #56ccf2; text-decoration: none; transition: color 0.3s ease; }
    a.email-link:hover { color: #2f80ed; text-decoration: underline; }

    /* --- FIXED: MOBILE HEADER LAYOUT --- */
    @media (max-width: 768px) {
      .header-top {
        display: grid;
        grid-template-columns: 1fr 1fr; /* Split top into 2 columns */
        gap: 15px;
        align-items: center;
      }

      /* Manchester Logo (Top Left) */
      .header-top > img:first-child {
        grid-column: 1;
        justify-self: start;
        height: 50px; /* Smaller for mobile */
      }

      /* Raico Logo (Top Right) */
      .header-top > img:last-child {
        grid-column: 2;
        justify-self: end;
        height: 50px; /* Smaller for mobile */
      }

      /* Title (Bottom Row) */
      header h1 {
        grid-column: 1 / -1; /* Span full width */
        grid-row: 2;         /* Move to second row */
        font-size: 1.6rem;
        margin-top: 10px;
      }
      
      header { margin-top: 30px; }
    }

    /* CITE BUTTON */
    .cite-btn {
      background: rgba(255, 255, 255, 0.05); border: 1px solid #56ccf2;
      color: #56ccf2; padding: 8px 18px; border-radius: 20px;
      cursor: pointer; transition: all 0.3s ease; margin-top: 15px;
      font-size: 0.85rem; font-weight: 500;
    }
    .cite-btn:hover { background: #56ccf2; color: #0b0f17; }

    /* --- STICKY BAR --- */
    .sticky-bar {
      position: fixed; top: 0; left: 0; width: 100%; min-height: 65px;
      background: rgba(15, 20, 30, 0.9); backdrop-filter: blur(8px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
      display: flex; align-items: center; justify-content: space-between;
      padding: 8px 20px; opacity: 0; pointer-events: none;
      transform: translateY(-100%); transition: opacity 0.4s ease, transform 0.4s ease;
      z-index: 100; flex-wrap: wrap;
    }
    .sticky-bar.visible { opacity: 1; pointer-events: all; transform: translateY(0); }
    .sticky-logo { height: 40px; object-fit: contain; }
    .sticky-title {
      flex: 1; text-align: center; font-size: 1rem; font-weight: 500;
      background: linear-gradient(to right, #56ccf2, #2f80ed);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      margin: 5px 10px; line-height: 1.3;
    }

    /* --- TABS --- */
    .tabs { display: flex; justify-content: center; align-items: center; gap: 40px; flex-wrap: wrap; margin: 50px 20px; }
    .tab {
      background: #1e2738; border-radius: 15px; width: 260px; height: 160px; text-align: center;
      display: flex; justify-content: center; align-items: center; color: #fff; text-decoration: none;
      font-size: 1.1rem; font-weight: 500; box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      transition: all 0.3s ease; position: relative; cursor: pointer;
    }
    .tab::before {
      content: ''; position: absolute; inset: 0; border-radius: 15px;
      background: linear-gradient(135deg, #2f80ed, #56ccf2); opacity: 0; transition: opacity 0.3s ease; z-index: -1;
    }
    .tab:hover { transform: translateY(-6px) scale(1.05); color: #fff; }
    .tab:hover::before { opacity: 1; }

    /* --- SUMMARY --- */
    .summary {
      max-width: 850px; text-align: justify; line-height: 1.6; color: #d6d6d6;
      margin: 20px 20px 40px 20px; background: rgba(255,255,255,0.05);
      padding: 25px 30px; border-radius: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.3);
    }
    .summary h2 { text-align: center; font-size: 1.5rem; color: #56ccf2; margin-bottom: 15px; }

    /* --- BEFORE/AFTER SLIDER STYLES --- */
    .comparison-section {
      text-align: center; margin: 40px auto; max-width: 800px; width: 95%;
    }

    .img-comp-container {
      position: relative;
      height: 450px;
      width: 100%;
      max-width: 800px; 
      margin: 20px auto;
      overflow: hidden; 
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(86, 204, 242, 0.2); 
      border: 2px solid #2f80ed;
    }

    .img-comp-img {
      position: absolute;
      top: 0; left: 0;
      width: auto; height: auto;
      overflow: hidden;
    }

    .img-comp-img img {
      display: block;
      width: 800px;
      height: 450px;
      max-width: none;
      object-fit: cover;
      user-select: none;
    }

    /* --- FIXED: MOBILE SLIDER --- */
    @media (max-width: 480px) {
      .img-comp-container { 
        height: 250px; 
      }
      .img-comp-img img { 
        height: 250px; 
        /* Fix: Set width to viewport width (90vw) instead of 100% 
           so it doesn't shrink inside the slider overlay */
        width: 90vw; 
        max-width: none; 
        object-fit: cover; 
      }
    }

    /* Slider Handle Styles */
    .img-comp-slider {
      position: absolute;
      z-index: 9;
      cursor: ew-resize;
      width: 40px; 
      height: 40px; 
      background: #56ccf2;
      border-radius: 50%; 
      border: 3px solid #fff;
      display: flex; 
      justify-content: center; 
      align-items: center;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    .img-comp-slider::before { content: 'â‡„'; color: #000; font-weight: bold; font-size: 18px; }

    /* --- PIPELINE ANIMATION --- */
    .pipeline-section {
      width: 100%; max-width: 1200px; margin: 50px auto;
      text-align: center; overflow: hidden; padding: 40px 0;
    }
    .pipeline-section h2 { font-size: 1.8rem; color: #56ccf2; margin-bottom: 40px; }

    .pipeline-wrapper {
      position: relative; width: 100%; height: 240px;
      background: rgba(255, 255, 255, 0.02);
      border-y: 1px solid rgba(86, 204, 242, 0.1);
      display: flex; align-items: center; justify-content: center; overflow: hidden;
    }
    .pipeline-grid {
      display: grid; grid-template-columns: repeat(9, 1fr); 
      align-items: center; justify-items: center;
      width: 1000px; max-width: 95%; position: relative;
    }

    .io-stage { position: relative; width: 60px; height: 60px; display: flex; justify-content: center; align-items: center; }
    .io-img {
      width: 100%; height: 100%; border-radius: 6px;
      border: 2px solid #56ccf2; object-fit: cover; background: #000;
      box-shadow: 0 0 10px rgba(86, 204, 242, 0.3);
    }

    .input-anim { animation: shrinkInput 20s linear infinite; }
    @keyframes shrinkInput {
      0% { transform: scale(1); opacity: 1; }
      5% { transform: scale(0); opacity: 0; }
      95% { transform: scale(0); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    .output-anim { animation: expandOutput 20s linear infinite; transform: scale(0); }
    @keyframes expandOutput {
      0%, 85% { transform: scale(0); opacity: 0; }
      90% { transform: scale(1.5); opacity: 1; }
      95%, 100% { transform: scale(1); opacity: 1; }
    }

    .traveling-dot {
      position: absolute; top: 50%; left: 0; 
      width: 14px; height: 14px; background: #56ccf2;
      border-radius: 50%; transform: translate(-50%, -50%);
      box-shadow: 0 0 15px #56ccf2; z-index: 50;
      pointer-events: none; animation: dotMove 20s linear infinite;
    }
    @keyframes dotMove {
      0% { left: 0%; opacity: 0; } 2% { opacity: 1; } 5% { left: 0%; opacity: 1; }
      9% { left: 12.5%; opacity: 1; } 10%, 15% { opacity: 0; } 16% { opacity: 1; }
      19% { left: 25%; opacity: 1; } 20%, 25% { opacity: 0; } 26% { opacity: 1; }
      29% { left: 37.5%; opacity: 1; } 30%, 35% { opacity: 0; } 36% { opacity: 1; }
      39% { left: 50%; opacity: 1; } 40%, 45% { opacity: 0; } 46% { opacity: 1; }
      49% { left: 62.5%; opacity: 1; } 50%, 55% { opacity: 0; } 56% { opacity: 1; }
      59% { left: 75%; opacity: 1; } 60%, 65% { opacity: 0; } 66% { opacity: 1; }
      69% { left: 87.5%; opacity: 1; } 70%, 75% { opacity: 0; } 76% { opacity: 1; }
      84% { left: 100%; opacity: 1; } 85% { opacity: 0; } 100% { left: 100%; opacity: 0; }
    }

    .layer-box { position: relative; display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; overflow: visible; }
    .layer-shape {
      background: #1e2738; border: 1px solid #2f80ed;
      border-radius: 4px; position: relative; z-index: 10;
      transition: border-color 0.2s; animation: zIndexBump 20s linear infinite;
      animation-delay: var(--delay);
    }
    .layer-shape::after {
      content: ""; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%); width: 100%; height: 100%;
      background-image: var(--img); background-size: cover; background-position: center;
      border: 2px solid #56ccf2; box-shadow: 0 0 25px rgba(0,0,0,0.9);
      opacity: 0; pointer-events: none; animation: popImage 20s linear infinite;
      animation-delay: var(--delay);
    }
    @keyframes zIndexBump {
      0% { z-index: 10; border-color: #2f80ed; } 0.1% { z-index: 500; border-color: #fff; } 
      5% { z-index: 10; border-color: #2f80ed; } 100% { z-index: 10; }
    }
    @keyframes popImage {
      0% { opacity: 0; width: 100%; height: 100%; } 0.1% { opacity: 1; background-color: #000; }
      1%, 4% { opacity: 1; width: 150px; height: 150px; } 5% { opacity: 0; width: 100%; height: 100%; } 100% { opacity: 0; }
    }
    .s-32 { width: 20px; height: 90px; } .s-64 { width: 25px; height: 70px; } .s-128 { width: 30px; height: 50px; }
    .s-256 { width: 40px; height: 40px; border-color: #fff; }
    .d-1 { --delay: 2s; } .d-2 { --delay: 4s; } .d-3 { --delay: 6s; } .d-4 { --delay: 8s; }
    .d-5 { --delay: 10s; } .d-6 { --delay: 12s; } .d-7 { --delay: 14s; }
    .connector-line { position: absolute; top: 50%; left: 0; width: 100%; height: 2px; background: rgba(255, 255, 255, 0.1); z-index: 0; }

    /* --- GALLERY --- */
    .gallery-section { max-width: 950px; margin: 40px auto; text-align: center; }
    .gallery-section h2 { font-size: 1.5rem; color: #56ccf2; margin-bottom: 25px; }
    .gallery-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; padding: 0 20px; }
    .gallery-item {
      position: relative; cursor: pointer; border-radius: 12px; overflow: hidden;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3); transition: transform 0.3s ease;
    }
    .gallery-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
    .gallery-item:hover img { transform: scale(1.05); }

    /* --- MODALS --- */
    .image-modal {
      display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9);
      justify-content: center; align-items: center; z-index: 2000;
    }
    .image-modal img { max-width: 90%; max-height: 90vh; border-radius: 10px; box-shadow: 0 0 25px rgba(86, 204, 242, 0.4); }
    .close-modal { position: absolute; top: 15px; right: 25px; font-size: 30px; color: #fff; cursor: pointer; font-weight: bold; transition: color 0.3s ease; }
    .close-modal:hover { color: #56ccf2; }

    .video-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); justify-content: center; align-items: center; z-index: 1001; }
    .video-container { position: relative; width: 80%; max-width: 800px; background: #000; border-radius: 10px; overflow: hidden; box-shadow: 0 0 25px rgba(86,204,242,0.4); }
    iframe, video { width: 100%; height: 450px; border: none; outline: none; }
    .close-btn { position: absolute; top: 10px; right: 15px; color: #fff; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.3s ease; }
    .close-btn:hover { color: #56ccf2; }

    /* --- CHATBOT --- */
    .chat-trigger {
      position: fixed; bottom: 30px; right: 30px;
      width: 60px; height: 60px; background: linear-gradient(135deg, #2f80ed, #56ccf2);
      border-radius: 50%; box-shadow: 0 4px 15px rgba(47, 128, 237, 0.5);
      display: flex; justify-content: center; align-items: center;
      cursor: pointer; z-index: 1500; transition: transform 0.3s ease;
    }
    .chat-trigger:hover { transform: scale(1.1); }
    .chat-icon { width: 30px; height: 30px; fill: white; }

    .chat-window {
      position: fixed; bottom: 100px; right: 30px;
      width: 350px; height: 500px; background: #151a25;
      border: 1px solid rgba(86, 204, 242, 0.3); border-radius: 15px;
      box-shadow: 0 5px 30px rgba(0,0,0,0.5);
      display: flex; flex-direction: column; overflow: hidden;
      z-index: 1500; opacity: 0; pointer-events: none;
      transform: translateY(20px); transition: all 0.3s ease;
    }
    .chat-window.active { opacity: 1; pointer-events: all; transform: translateY(0); }

    .chat-header {
      background: linear-gradient(to right, #1c2230, #2f80ed); padding: 15px;
      display: flex; justify-content: space-between; align-items: center;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .chat-header h3 { font-size: 1rem; color: #fff; margin: 0; }
    .close-chat { cursor: pointer; color: #ccc; font-size: 1.2rem; }

    .chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
    .message { max-width: 80%; padding: 10px 14px; border-radius: 10px; font-size: 0.9rem; line-height: 1.4; }
    .bot-msg { background: rgba(86, 204, 242, 0.15); color: #e0e0e0; align-self: flex-start; border-top-left-radius: 2px; }
    .user-msg { background: #2f80ed; color: #fff; align-self: flex-end; border-bottom-right-radius: 2px; }

    .chat-input-area {
      padding: 15px; background: #0b0f17;
      border-top: 1px solid rgba(255,255,255,0.1);
      display: flex; flex-direction: column; gap: 10px;
    }
    
    /* CHAT CHIPS */
    .chat-chips {
      display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px;
      scrollbar-width: none; /* Firefox */
    }
    .chat-chips::-webkit-scrollbar { display: none; /* Chrome/Safari */ }
    
    .chip {
      background: rgba(47, 128, 237, 0.2); color: #fff;
      padding: 6px 12px; border-radius: 12px; font-size: 0.75rem;
      white-space: nowrap; cursor: pointer; border: 1px solid rgba(47, 128, 237, 0.5);
      transition: background 0.2s;
    }
    .chip:hover { background: #2f80ed; }

    .chat-bar-row { display: flex; gap: 10px; width: 100%; }
    .chat-input {
      flex: 1; background: #1e2738; border: none; outline: none;
      color: #fff; padding: 10px; border-radius: 5px;
    }
    .send-btn {
      background: #2f80ed; border: none; color: white;
      padding: 0 15px; border-radius: 5px; cursor: pointer; font-weight: bold;
    }
    .send-btn:hover { background: #56ccf2; }

    footer { text-align: center; font-size: 0.85rem; color: #808080; margin: 40px 0; }

    /* --- RESPONSIVE --- */
    @media (max-width: 768px) {
      .pipeline-wrapper { height: 160px; display: flex; align-items: center; justify-content: center; }
      .pipeline-grid { width: 1000px; max-width: none; transform: scale(0.35); transform-origin: center center; margin: 0; }
    }
    @media (max-width: 480px) {
      .gallery-grid { grid-template-columns: 1fr; }
      .chat-window { width: 90%; right: 5%; bottom: 100px; height: 60vh; }
      
      /* Revisit slider styling to ensure overrides work */
      .img-comp-container { height: 250px; }
      .img-comp-img img { height: 250px; width: 90vw; max-width: none; }
    }

    /* --- IMPACT / APPLICATIONS SECTION --- */
    .impact-section {
      max-width: 1100px; margin: 60px auto; width: 95%; text-align: center;
    }
    .impact-section h2 { 
      font-size: 1.8rem; color: #56ccf2; margin-bottom: 10px; 
    }

    .impact-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px;
    }

    .impact-card {
      background: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 15px; padding: 30px 20px;
      transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s;
      display: flex; flex-direction: column; align-items: center;
    }

    /* Hover Effect: Card pops up and glows */
    .impact-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      border-color: #2f80ed;
      background: rgba(47, 128, 237, 0.05);
    }

    .icon-box {
      width: 60px; height: 60px; margin-bottom: 20px;
      display: flex; justify-content: center; align-items: center;
      background: rgba(0, 0, 0, 0.3); border-radius: 50%;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .icon-box svg { width: 32px; height: 32px; }

    .impact-card h3 {
      color: #fff; font-size: 1.2rem; margin-bottom: 15px; font-weight: 500;
    }

    .impact-card p {
      color: #c5c5c5; font-size: 0.95rem; line-height: 1.6;
    }

    /* Mobile Responsiveness */
    @media (max-width: 768px) {
      .impact-grid { grid-template-columns: 1fr; max-width: 400px; margin: 0 auto; }
    }
  </style>
</head>
<body>

<header id="header">
  <div class="header-top">
    <img src="images/uom.png" alt="Left Logo" class="corner-logo">
    <h1>Autonomous Navigation in Dark Unknown Environments using Vision</h1>
    <img src="images/raico.png" alt="Right Logo" class="corner-logo">
  </div>
  <p><strong>PhD Student:</strong> <a href="mailto:nathan.shankar@postgrad.manchester.ac.uk" class="email-link">Nathan Shankar</a></p>
  <p class="supervisors">
    Supervisors:
    <a href="mailto:pawel.ladosz@manchester.ac.uk" class="email-link">Pawel Ladosz</a> &nbsp; | &nbsp;
    <a href="mailto:hujun.yin@manchester.ac.uk" class="email-link">Hujun Yin</a>
  </p>
  <button onclick="copyBibtex()" class="cite-btn">ðŸ“„ Cite this Research</button>
</header>

<div class="sticky-bar" id="stickyBar">
  <img src="images/uom.png" alt="Left Logo" class="sticky-logo">
  <div class="sticky-title">Autonomous Navigation in Dark Unknown Environments using Vision</div>
  <img src="images/raico.png" alt="Right Logo" class="sticky-logo">
</div>

<div class="tabs">
  <div class="tab" id="goals-tab">Research Goals</div>
  <div class="tab" id="demo-tab">Autonomous Exploration in the Dark Demo</div>
  <div class="tab" id="ir-tab">Object Detection using Infrared Camera Demo</div>
  <a href="https://arxiv.org/pdf/2510.04883" target="_blank" class="tab">Research Paper</a>
</div>

<section class="summary">
  <h2>About the Research</h2>
  <p>Robots struggle when the lights go out, resulting in camera failure, loss of localization, and breakdown of navigation systems.
     This research aims to give robots the ability to perceive and navigate reliably in complete darkness by combining infrared sensing,
     intelligent image enhancement, and spatial awareness.
  </p><br>
  <p>The goal is to make vision reliable anywhere without relying on a multitude of sensors.
     By leveraging infrared perception and learning-based enhancement, robots can reconstruct their surroundings,
     recognize objects, and navigate safely in environments where conventional vision fails.
     This research has significant implications for autonomous exploration, search and rescue, warehouse fleets,
     nuclear inspection, and planetary robotics.
  </p>
</section>

<section class="comparison-section">
  <h2>Restoration Results</h2>
  <p style="margin-bottom: 20px; color: #ccc; font-size:0.9rem;">Drag the slider to see the image enhancement in real-time.</p>
  
  <div class="img-comp-container">
    <div class="img-comp-img">
      <img src="layer/13_conv2d_7.png" alt="Clean Output">
    </div>
    <div class="img-comp-img img-comp-overlay">
      <img src="layer/input_image.png" alt="Noisy Input">
    </div>
  </div>
</section>

<section class="pipeline-section">
  <h2>Processing Pipeline</h2>
  <div class="pipeline-wrapper">
    <div class="pipeline-grid">
      <div class="connector-line"></div>
      <div class="traveling-dot"></div>

      <div class="io-stage">
        <img src="layer/input_image.png" class="io-img input-anim" alt="Input">
        <span style="position: absolute; bottom: -30px; font-size: 0.7rem; color: #888; width: 100px;">Noisy Input</span>
      </div>

      <div class="layer-box"><div class="layer-shape s-32 d-1" style="--img: url('layer/00_conv2d.png')"></div></div>
      <div class="layer-box"><div class="layer-shape s-64 d-2" style="--img: url('layer/02_conv2d_1.png')"></div></div>
      <div class="layer-box"><div class="layer-shape s-128 d-3" style="--img: url('layer/04_conv2d_2.png')"></div></div>
      <div class="layer-box"><div class="layer-shape s-256 d-4" style="--img: url('layer/06_conv2d_3.png')"></div></div>
      <div class="layer-box"><div class="layer-shape s-128 d-5" style="--img: url('layer/08_conv2d_4.png')"></div></div>
      <div class="layer-box"><div class="layer-shape s-64 d-6" style="--img: url('layer/10_conv2d_5.png')"></div></div>
      <div class="layer-box"><div class="layer-shape s-32 d-7" style="--img: url('layer/12_conv2d_6.png')"></div></div>

      <div class="io-stage">
        <img src="layer/13_conv2d_7.png" class="io-img output-anim" alt="Output">
        <span style="position: absolute; bottom: -30px; font-size: 0.7rem; color: #888; width: 100px;">Clean Output</span>
      </div>
    </div>
  </div>
  <p style="margin-top: 15px; color: #aaa; font-size: 0.9rem;">
    <strong>Under the hood:</strong> The noisy input is compressed into latent features (bottleneck) 
    and reconstructed. Different layers reveal their internal feature maps during processing.
  </p>
</section>

<section class="impact-section">
  <h2>Real-World Impact</h2>
  <p style="color:#aaa; margin-bottom: 40px; text-align:center;">
    Deploying autonomous vision where humans cannot go.
  </p>

  <div class="impact-grid">
    
    <div class="impact-card">
      <div class="icon-box">
        <svg viewBox="0 0 24 24" fill="none" stroke="#ff5f56" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-2.246-5.318-2.5-7a1 1 0 1 0-2 0c0 1.333.5 5.2 1.61 9.309a2.5 2.5 0 0 0 1.39 3.191zM12 19l2.5-3.5L13 14h2.5L12 11l-2.5 3.5L11 16H8.5L12 19z"/></svg>
      </div>
      <h3>Search & Rescue</h3>
      <p>Finding survivors in low-light buildings or collapsed tunnels where standard cameras are blinded and GPS fails.</p>
    </div>

    <div class="impact-card">
      <div class="icon-box">
        <svg viewBox="0 0 24 24" fill="none" stroke="#56ccf2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg>
      </div>
      <h3>Space Exploration</h3>
      <p>Navigating the permanently shadowed craters of the Moon or Mars caves without draining battery on heavy floodlights.</p>
    </div>

    <div class="impact-card">
      <div class="icon-box">
        <svg viewBox="0 0 24 24" fill="none" stroke="#27c93f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"/><path d="M12 12v6"/><path d="M12 12L7.5 7.5"/><path d="M12 12l4.5-4.5"/></svg>
      </div>
      <h3>Industrial Inspection</h3>
      <p>Monitoring high-risk zones in nuclear plants or deep mines, keeping human workers safe from radiation and hazards.</p>
    </div>

  </div>
</section>

<section class="gallery-section">
  <h2>Research Gallery</h2>
  <div class="gallery-grid" id="gallery"></div>
</section>

<footer>Â© 2025 Nathan Shankar â€” University of Manchester</footer>

<div class="image-modal" id="imageModal">
  <span class="close-modal" id="closeImageModal">&times;</span>
  <img id="modalImg" src="" alt="">
</div>

<div class="video-modal" id="goals-modal">
  <div class="video-container">
    <span class="close-btn" data-close="goals-modal">&times;</span>
    <iframe id="goals-iframe" data-src="https://www.youtube.com/embed/RJ8qQAx-SoI?autoplay=1"></iframe>
  </div>
</div>
<div class="video-modal" id="demo-modal">
  <div class="video-container">
    <span class="close-btn" data-close="demo-modal">&times;</span>
    <video id="nav-video" controls><source src="nav_in_dark.mp4" type="video/mp4"></video>
  </div>
</div>
<div class="video-modal" id="ir-modal">
  <div class="video-container">
    <span class="close-btn" data-close="ir-modal">&times;</span>
    <video id="ir-video" controls><source src="ir_object_detect_1.mp4" type="video/mp4"></video>
  </div>
</div>

<div class="chat-trigger" onclick="toggleChat()">
  <svg class="chat-icon" viewBox="0 0 24 24">
    <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
  </svg>
</div>

<div class="chat-window" id="chatWindow">
  <div class="chat-header">
    <h3>Research Assistant</h3>
    <span class="close-chat" onclick="toggleChat()">&times;</span>
  </div>
  <div class="chat-messages" id="chatMessages">
    <div class="message bot-msg">
      Hello! I can explain how this research applies to your industry. 
      <br><br>
      <strong>Which sector do you work in?</strong>
    </div>
  </div>
  <div class="chat-input-area">
    <div class="chat-chips">
      <span class="chip" onclick="sendChip('Nuclear')">Nuclear</span>
      <span class="chip" onclick="sendChip('Space')">Space</span>
      <span class="chip" onclick="sendChip('Rescue')">Rescue</span>
      <span class="chip" onclick="sendChip('Why not LiDAR?')">Why not LiDAR?</span>
    </div>
    
    <div class="chat-bar-row">
      <input type="text" id="chatInput" class="chat-input" placeholder="Type..." onkeypress="handleEnter(event)">
      <button class="send-btn" onclick="sendMessage()">Send</button>
    </div>
  </div>
</div>

<script>
  // ================= 1. UI LOGIC (Sticky Header, Citation, Modals) =================
  
  // Sticky Header
  const header = document.getElementById('header');
  const stickyBar = document.getElementById('stickyBar');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (!entry.isIntersecting || entry.intersectionRatio < 1) stickyBar.classList.add('visible');
      else stickyBar.classList.remove('visible');
    });
  }, { threshold: Array.from({ length: 100 }, (_, i) => i / 100) });
  observer.observe(header);

  // Citation Logic
  function copyBibtex() {
    const bibtex = `@article{shankar2025autonomous,
  title={Autonomous Navigation in Dark Unknown Environments using Vision},
  author={Shankar, Nathan and Ladosz, Pawel and Yin, Hujun},
  journal={arXiv preprint arXiv:2510.04883},
  year={2025}
}`;
    navigator.clipboard.writeText(bibtex).then(() => {
      const btn = document.querySelector('.cite-btn');
      const originalText = btn.innerText;
      btn.innerText = "âœ… BibTeX Copied!";
      setTimeout(() => btn.innerText = originalText, 2000);
    });
  }

  // Video Modal Logic
  const openModal = id => {
    closeAllVideos();
    const modal = document.getElementById(id);
    modal.style.display = 'flex';
    const iframe = modal.querySelector('iframe');
    if (iframe) iframe.src = iframe.dataset.src;
    const video = modal.querySelector('video');
    if (video) video.play();
  };
  const closeModal = id => {
    const modal = document.getElementById(id);
    modal.style.display = 'none';
    const iframe = modal.querySelector('iframe');
    const video = modal.querySelector('video');
    if (iframe) iframe.src = '';
    if (video) { video.pause(); video.currentTime = 0; }
  };
  const closeAllVideos = () => document.querySelectorAll('.video-modal').forEach(m => closeModal(m.id));
  
  document.getElementById('goals-tab').onclick = () => openModal('goals-modal');
  document.getElementById('demo-tab').onclick = () => openModal('demo-modal');
  document.getElementById('ir-tab').onclick = () => openModal('ir-modal');
  document.querySelectorAll('.close-btn').forEach(btn => btn.addEventListener('click', e => closeModal(e.target.dataset.close)));
  window.onclick = e => { if (e.target.classList.contains('video-modal')) closeModal(e.target.id); };

  // ================= 2. GALLERY LOGIC =================
  const gallery = document.getElementById('gallery');
  const imageModal = document.getElementById('imageModal');
  const modalImg = document.getElementById('modalImg');
  const closeImageModal = document.getElementById('closeImageModal');

  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  fetch('uploads/index.json')
    .then(res => res.json())
    .then(photos => {
      photos = shuffleArray(photos);
      photos.forEach(src => {
        const div = document.createElement('div');
        div.className = 'gallery-item';
        const img = document.createElement('img');
        img.src = src;
        div.appendChild(img);
        div.onclick = () => {
          modalImg.src = src;
          imageModal.style.display = 'flex';
        };
        gallery.appendChild(div);
      });
    })
    .catch(err => {
      console.error("Could not load image list:", err);
      gallery.innerHTML = "<p style='color:#999;'>No images found in uploads folder.</p>";
    });

  closeImageModal.onclick = () => imageModal.style.display = 'none';
  window.addEventListener('click', e => { if (e.target === imageModal) imageModal.style.display = 'none'; });

  // ================= 3. BEFORE/AFTER SLIDER LOGIC =================
  function initComparisons() {
    var x, i;
    x = document.getElementsByClassName("img-comp-overlay");
    for (i = 0; i < x.length; i++) {
      compareImages(x[i]);
    }
    function compareImages(img) {
      var slider, clicked = 0, w, h;
      w = img.offsetWidth;
      h = img.offsetHeight;
      img.style.width = (w / 2) + "px";
      
      slider = document.createElement("DIV");
      slider.setAttribute("class", "img-comp-slider");
      img.parentElement.insertBefore(slider, img);
      
      // Center slider
      slider.style.top = (h / 2) - (slider.offsetHeight / 2) + "px";
      slider.style.left = (w / 2) - (slider.offsetWidth / 2) + "px";
      
      slider.addEventListener("mousedown", slideReady);
      window.addEventListener("mouseup", slideFinish);
      slider.addEventListener("touchstart", slideReady);
      window.addEventListener("touchend", slideFinish);

      function slideReady(e) {
        e.preventDefault();
        clicked = 1;
        window.addEventListener("mousemove", slideMove);
        window.addEventListener("touchmove", slideMove);
      }
      function slideFinish() {
        clicked = 0;
      }
      function slideMove(e) {
        var pos;
        if (clicked == 0) return false;
        pos = getCursorPos(e);
        if (pos < 0) pos = 0;
        if (pos > w) pos = w;
        slide(pos);
      }
      function getCursorPos(e) {
        var a, x = 0;
        e = (e.changedTouches) ? e.changedTouches[0] : e;
        a = img.getBoundingClientRect();
        x = e.pageX - a.left;
        x = x - window.pageXOffset;
        return x;
      }
      function slide(x) {
        img.style.width = x + "px";
        slider.style.left = img.offsetWidth - (slider.offsetWidth / 2) + "px";
      }
    }
  }
  // Initialize slider when page loads
  initComparisons();


  // ================= 4. CHATBOT LOGIC =================
  const knowledgeBase = [
    // === GREETINGS (Hidden from lists) ===
    {
      type: "greeting", 
      topic: "Greeting",
      keywords: ["hi", "hello", "hey", "greetings", "good morning", "good evening", "yo", "test"],
      response: "Hello! I am an AI research assistant. I can explain how this autonomous navigation technology benefits specific industries (like Nuclear, Space, or Mining) or answer technical questions (like 'Why not use a torch?'). <br><br><strong>Try using the buttons below or asking about a specific sector!</strong>"
    },

    // === SECTORS ===
    {
      type: "sector",
      topic: "Nuclear & Radiation",
      keywords: ["nuclear", "radiation", "plant", "atomic"],
      response: "In the **Nuclear** sector, this technology is vital. Radioactive containment zones are often pitch black and dangerous for humans. My research allows autonomous robots to inspect pipes and tunnels using infrared vision without needing active lighting, which reduces complexity and failure points in high-radiation zones."
    },
    {
      type: "sector",
      topic: "Warehousing & Logistics",
      keywords: ["warehouse", "logistics", "supply chain", "factory", "storage"],
      response: "For **Warehousing & Logistics**, this enables 'Lights-Out Automation'. Robots can operate safely in complete darkness, allowing companies to turn off warehouse lights to save massive amounts of energy while maintaining 24/7 autonomous operations without navigation loss."
    },
    {
      type: "sector",
      topic: "Search & Rescue",
      keywords: ["rescue", "fire", "disaster", "emergency", "police", "search"],
      response: "In **Search & Rescue**, standard cameras fail in smoke-filled or unlit collapsed buildings. By fusing infrared data with our deep learning model, rescue rovers can navigate debris in zero-visibility conditions to find survivors where humans or standard robots cannot go."
    },
    {
      type: "sector",
      topic: "Space Exploration",
      keywords: ["space", "mars", "moon", "planetary", "nasa", "esa"],
      response: "For **Space Exploration**, rovers often face 'Permanently Shadowed Regions' (like lunar craters) where sunlight never reaches. This research allows rovers to navigate these unknown dark terrains autonomously without relying on power-hungry floodlights or GPS."
    },
    {
      type: "sector",
      topic: "Surveillance",
      keywords: ["security", "defense", "military", "surveillance", "guard"],
      response: "For **Surveillance**, this technology enables stealth. Robots can patrol perimeters in total darkness without using flashlights that would give away their position, utilizing enhanced infrared imagery to detect intruders."
    },
    {
      type: "sector",
      topic: "Mining & Underground",
      keywords: ["mining", "underground", "cave", "tunnel"],
      response: "In **Mining**, deep underground tunnels are often poorly lit and hazardous. This vision system allows autonomous excavators and inspection drones to map and navigate unstable mine shafts without requiring extensive external lighting infrastructure."
    },

    // === COMMON RESEARCH QUESTIONS ===
    {
      type: "faq",
      topic: "Why not use a torch/flashlight?",
      keywords: ["torch", "light", "flashlight", "lamp", "illuminat", "spotlight"],
      response: "Great question! Using active lighting (a torch) has three major downsides: <br>1. **Power:** High-intensity lights drain the robot's battery quickly.<br>2. **Backscatter:** In fog, smoke, or dust, visible light reflects off particles and blinds the camera (like high beams in fog).<br>3. **Stealth:** In security or nature observation, visible light disturbs the environment or reveals the robot's location."
    },
    {
      type: "faq",
      topic: "Why not use LiDAR?",
      keywords: ["lidar", "laser", "scanner"],
      response: "LiDAR is accurate but has limitations. It is often **heavy, expensive, and power-hungry** compared to cameras. Furthermore, LiDAR only provides geometric data (shapes), whereas my vision-based approach provides semantic data (understanding *what* an object is), which is crucial for interacting with the environment."
    },
    {
      type: "faq",
      topic: "Why not use GPS?",
      keywords: ["gps", "satellite", "location"],
      response: "GPS signals cannot penetrate deep underground, inside thick concrete buildings, or underwater. My research focuses on **GPS-denied environments**, requiring the robot to calculate its position solely based on what it 'sees' relative to its starting point."
    },
    {
      type: "faq",
      topic: "Why not use Thermal Imaging?",
      keywords: ["thermal", "heat", "temperature"],
      response: "Thermal cameras are great for detecting heat (like people or engines), but they struggle with **navigation**. A cold wall looks the same as a cold floor in thermal imaging, making it hard to find edges or obstacles. My research uses Near-Infrared (NIR) or enhanced visual data, which preserves textures and edges necessary for navigation."
    },
    {
      type: "faq",
      topic: "Does this require a supercomputer?",
      keywords: ["compute", "gpu", "processor", "heavy", "slow", "fast", "speed"],
      response: "No, a key goal of this research is **efficiency**. The deep learning models are optimized to run on edge devices (like an NVIDIA Jetson or Raspberry Pi) that can fit on a small drone or rover, rather than requiring a massive server."
    },
    {
      type: "faq",
      topic: "How is this different from Night Vision Goggles?",
      keywords: ["night vision", "goggles", "nvg", "green"],
      response: "Standard night vision (image intensification) amplifies existing light, but it often results in grainy, low-contrast images that are hard for *computers* to analyze. My method uses **Deep Learning** to mathematically reconstruct a clean, sharp image from noisy data, making it much better for autonomous algorithms to understand."
    },
    {
      type: "faq",
      topic: "Can it recognize specific objects?",
      keywords: ["recognize", "identify", "objects", "detect"],
      response: "Yes! Once the image is enhanced by the pipeline, we can run standard object detection algorithms (like YOLO) on it. In our tests, we successfully detected people, chairs, and tools in near-total darkness where standard detection failed completely."
    }
  ];

  const chatWindow = document.getElementById('chatWindow');
  const chatMessages = document.getElementById('chatMessages');
  const chatInput = document.getElementById('chatInput');

  function toggleChat() {
    chatWindow.classList.toggle('active');
    if (chatWindow.classList.contains('active')) chatInput.focus();
  }

  function handleEnter(e) {
    if (e.key === 'Enter') sendMessage();
  }
  
  // Chip Click Handler
  function sendChip(text) {
    chatInput.value = text;
    sendMessage();
  }

  function sendMessage() {
    const text = chatInput.value.trim();
    if (!text) return;
    addMessage(text, 'user-msg');
    chatInput.value = '';
    setTimeout(() => {
      const response = generateResponse(text);
      addMessage(response, 'bot-msg');
    }, 600);
  }

  function addMessage(html, type) {
    const div = document.createElement('div');
    div.className = `message ${type}`;
    div.innerHTML = html;
    chatMessages.appendChild(div);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  function generateResponse(input) {
    const lowerInput = input.toLowerCase();
    
    // 1. Try to find a match
    for (let entry of knowledgeBase) {
      if (entry.keywords.some(keyword => lowerInput.includes(keyword))) {
        return entry.response;
      }
    }
    
    // 2. Fallback: Dynamic Lists
    const sectorList = knowledgeBase
      .filter(entry => entry.type === 'sector')
      .map(entry => `<li>${entry.topic}</li>`)
      .join('');

    const faqList = knowledgeBase
      .filter(entry => entry.type === 'faq')
      .map(entry => `<li>${entry.topic}</li>`)
      .join('');

    return `I haven't been trained on that specific input yet. However, I can discuss:
            <br><br><strong>Industry Applications:</strong>
            <ul style="margin-top:5px; padding-left:20px; text-align:left;">
              ${sectorList}
            </ul>
            <br><strong>Common Questions:</strong>
            <ul style="margin-top:5px; padding-left:20px; text-align:left;">
              ${faqList}
            </ul>`;
  }
</script>
</body>
</html>